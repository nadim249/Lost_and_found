{% extends "layout.html" %}

{% block body %}
    <h2 class="mb-4">My Posts</h2>

    <div class="table-responsive">
        <table class="table table-hover align-middle shadow-sm bg-white rounded">
            <thead class="table-light">
                <tr>
                    <th>Image</th>
                    <th>Title</th>
                    <th>Status</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
                {% for item in items %}
                    <tr>
                        <td>
                            {% if item.image_path %}
                                <img src="{{ url_for('static', filename=item.image_path) }}" width="50" height="50" class="rounded object-fit-cover">
                            {% else %}
                                <span class="text-muted">No Img</span>
                            {% endif %}
                        </td>
                        <td>{{ item.title }}</td>
                        <td>
                            {% if item.status == 'Lost' %}
                                <span class="badge bg-danger">Lost</span>
                            {% elif item.status == 'Found' %}
                                <span class="badge bg-success">Found</span>
                            {% else %}
                                <span class="badge bg-secondary">{{ item.status }}</span>
                            {% endif %}
                        </td>
                        <td>
                            <a href="{{ url_for('item_detail', item_id=item.id) }}" class="btn btn-sm btn-info text-white" title="View">
                                <i class="fa-solid fa-eye"></i>
                            </a>

                            {% if item.status in ['Lost', 'Found'] %}
                                <a href="{{ url_for('edit_item', item_id=item.id) }}" class="btn btn-sm btn-warning text-white" title="Edit">
                                    <i class="fa-solid fa-pen"></i>
                                </a>

                                <form action="{{ url_for('resolve_item', item_id=item.id) }}" method="POST" class="d-inline">
                                    <button type="submit" class="btn btn-sm btn-success" title="Mark as Resolved/Returned" onclick="return confirm('Is this item officially resolved?');">
                                        <i class="fa-solid fa-check"></i>
                                    </button>
                                </form>
                            {% endif %}

                            <form action="{{ url_for('delete_item', item_id=item.id) }}" method="POST" class="d-inline" onsubmit="return confirm('Are you sure you want to delete this?');">
                                <button type="submit" class="btn btn-sm btn-danger" title="Delete">
                                    <i class="fa-solid fa-trash"></i>
                                </button>
                            </form>
                        </td>
                    </tr>
                {% else %}
                    <tr>
                        <td colspan="4" class="text-center py-4">You haven't posted anything yet.</td>
                    </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
{% endblock %}
